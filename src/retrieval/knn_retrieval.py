"""K-NN retrieval system."""import numpy as npfrom typing import Tupleclass KNNRetrieval:    """K-Nearest Neighbors retrieval."""        def __init__(self, k: int = 1):        self.k = k        self.database_embeddings = None        self.database_labels = None            def build_database(self, embeddings: np.ndarray, labels: np.ndarray):        """Build the retrieval database."""        self.database_embeddings = embeddings        self.database_labels = labels            def retrieve(self, query_embedding: np.ndarray) -> Tuple[np.ndarray, np.ndarray]:        """Retrieve k-nearest neighbors."""        distances = np.linalg.norm(            self.database_embeddings - query_embedding, axis=1        )        k_indices = np.argpartition(distances, min(self.k, len(distances)-1))[:self.k]        k_indices = k_indices[np.argsort(distances[k_indices])]        return distances[k_indices], self.database_labels[k_indices]        def predict(self, query_embedding: np.ndarray) -> str:        """Predict label using majority voting."""        _, labels = self.retrieve(query_embedding)        unique, counts = np.unique(labels, return_counts=True)        return unique[np.argmax(counts)]